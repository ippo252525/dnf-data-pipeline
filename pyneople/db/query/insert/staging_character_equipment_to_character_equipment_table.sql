TRUNCATE TABLE character_equipment;

INSERT INTO character_equipment (
    server_id,
    character_id,
    weapon_item_name,
    weapon_item_type_detail,
    weapon_item_available_level,
    weapon_item_rarity,
    weapon_reinforce,
    weapon_item_grade_name,
    weapon_enchant,
    weapon_amplification_name,
    weapon_refine,
    weapon_engrave_name,
    weapon_tune_level,
    title_item_name,
    title_enchant,
    jacket_item_name,
    jacket_item_available_level,
    jacket_item_rarity,
    jacket_set_item_name,
    jacket_reinforce,
    jacket_item_grade_name,
    jacket_enchant,
    jacket_amplification_name,
    jacket_upgrade_info_item_name,
    jacket_upgrade_info_item_rarity,
    jacket_upgrade_info_set_item_name,
    jacket_tune_level,
    shoulder_item_name,
    shoulder_item_available_level,
    shoulder_item_rarity,
    shoulder_set_item_name,
    shoulder_reinforce,
    shoulder_item_grade_name,
    shoulder_enchant,
    shoulder_amplification_name,
    shoulder_upgrade_info_item_name,
    shoulder_upgrade_info_item_rarity,
    shoulder_upgrade_info_set_item_name,
    shoulder_tune_level,
    pants_item_name,
    pants_item_available_level,
    pants_item_rarity,
    pants_set_item_name,
    pants_reinforce,
    pants_item_grade_name,
    pants_enchant,
    pants_amplification_name,
    pants_upgrade_info_item_name,
    pants_upgrade_info_item_rarity,
    pants_upgrade_info_set_item_name,
    pants_tune_level,
    shoes_item_name,
    shoes_item_available_level,
    shoes_item_rarity,
    shoes_set_item_name,
    shoes_reinforce,
    shoes_item_grade_name,
    shoes_enchant,
    shoes_amplification_name,
    shoes_upgrade_info_item_name,
    shoes_upgrade_info_item_rarity,
    shoes_upgrade_info_set_item_name,
    shoes_tune_level,
    waist_item_name,
    waist_item_available_level,
    waist_item_rarity,
    waist_set_item_name,
    waist_reinforce,
    waist_item_grade_name,
    waist_enchant,
    waist_amplification_name,
    waist_upgrade_info_item_name,
    waist_upgrade_info_item_rarity,
    waist_upgrade_info_set_item_name,
    waist_tune_level,
    amulet_item_name,
    amulet_item_available_level,
    amulet_item_rarity,
    amulet_set_item_name,
    amulet_reinforce,
    amulet_item_grade_name,
    amulet_enchant,
    amulet_amplification_name,
    amulet_upgrade_info_item_name,
    amulet_upgrade_info_item_rarity,
    amulet_upgrade_info_set_item_name,
    amulet_tune_level,
    wrist_item_name,
    wrist_item_available_level,
    wrist_item_rarity,
    wrist_set_item_name,
    wrist_reinforce,
    wrist_item_grade_name,
    wrist_enchant,
    wrist_amplification_name,
    wrist_upgrade_info_item_name,
    wrist_upgrade_info_item_rarity,
    wrist_upgrade_info_set_item_name,
    wrist_tune_level,
    ring_item_name,
    ring_item_available_level,
    ring_item_rarity,
    ring_set_item_name,
    ring_reinforce,
    ring_item_grade_name,
    ring_enchant,
    ring_amplification_name,
    ring_upgrade_info_item_name,
    ring_upgrade_info_item_rarity,
    ring_upgrade_info_set_item_name,
    ring_tune_level,
    support_item_name,
    support_item_available_level,
    support_item_rarity,
    support_set_item_name,
    support_reinforce,
    support_item_grade_name,
    support_enchant,
    support_amplification_name,
    support_fusion_option,
    support_upgrade_info_item_name,
    support_upgrade_info_item_rarity,
    support_upgrade_info_set_item_name,
    support_tune_level,
    magic_ston_item_name,
    magic_ston_item_available_level,
    magic_ston_item_rarity,
    magic_ston_set_item_name,
    magic_ston_reinforce,
    magic_ston_item_grade_name,
    magic_ston_enchant,
    magic_ston_amplification_name,
    magic_ston_fusion_option,
    magic_ston_upgrade_info_item_name,
    magic_ston_upgrade_info_item_rarity,
    magic_ston_upgrade_info_set_item_name,
    magic_ston_tune_level,
    earring_item_name,
    earring_item_available_level,
    earring_item_rarity,
    earring_set_item_name,
    earring_reinforce,
    earring_item_grade_name,
    earring_enchant,
    earring_amplification_name,
    earring_fusion_option,
    earring_upgrade_info_item_name,
    earring_upgrade_info_item_rarity,
    earring_upgrade_info_set_item_name,
    earring_tune_level,
    magic_ston_potency_value,
    earring_potency_value,
    total_set_item_name,
    total_set_point,
    fetched_at
)
SELECT
    server_id,
    character_id,
    weapon_item_name,
    weapon_item_type_detail,
    weapon_item_available_level,
    weapon_item_rarity,
    weapon_reinforce,
    weapon_item_grade_name,
    weapon_enchant,
    weapon_amplification_name,
    weapon_refine,
    weapon_engrave_name,
    weapon_tune_level,
    title_item_name,
    title_enchant,
    jacket_item_name,
    jacket_item_available_level,
    jacket_item_rarity,
    jacket_set_item_name,
    jacket_reinforce,
    jacket_item_grade_name,
    jacket_enchant,
    jacket_amplification_name,
    jacket_upgrade_info_item_name,
    jacket_upgrade_info_item_rarity,
    jacket_upgrade_info_set_item_name,
    jacket_tune_level,
    shoulder_item_name,
    shoulder_item_available_level,
    shoulder_item_rarity,
    shoulder_set_item_name,
    shoulder_reinforce,
    shoulder_item_grade_name,
    shoulder_enchant,
    shoulder_amplification_name,
    shoulder_upgrade_info_item_name,
    shoulder_upgrade_info_item_rarity,
    shoulder_upgrade_info_set_item_name,
    shoulder_tune_level,
    pants_item_name,
    pants_item_available_level,
    pants_item_rarity,
    pants_set_item_name,
    pants_reinforce,
    pants_item_grade_name,
    pants_enchant,
    pants_amplification_name,
    pants_upgrade_info_item_name,
    pants_upgrade_info_item_rarity,
    pants_upgrade_info_set_item_name,
    pants_tune_level,
    shoes_item_name,
    shoes_item_available_level,
    shoes_item_rarity,
    shoes_set_item_name,
    shoes_reinforce,
    shoes_item_grade_name,
    shoes_enchant,
    shoes_amplification_name,
    shoes_upgrade_info_item_name,
    shoes_upgrade_info_item_rarity,
    shoes_upgrade_info_set_item_name,
    shoes_tune_level,
    waist_item_name,
    waist_item_available_level,
    waist_item_rarity,
    waist_set_item_name,
    waist_reinforce,
    waist_item_grade_name,
    waist_enchant,
    waist_amplification_name,
    waist_upgrade_info_item_name,
    waist_upgrade_info_item_rarity,
    waist_upgrade_info_set_item_name,
    waist_tune_level,
    amulet_item_name,
    amulet_item_available_level,
    amulet_item_rarity,
    amulet_set_item_name,
    amulet_reinforce,
    amulet_item_grade_name,
    amulet_enchant,
    amulet_amplification_name,
    amulet_upgrade_info_item_name,
    amulet_upgrade_info_item_rarity,
    amulet_upgrade_info_set_item_name,
    amulet_tune_level,
    wrist_item_name,
    wrist_item_available_level,
    wrist_item_rarity,
    wrist_set_item_name,
    wrist_reinforce,
    wrist_item_grade_name,
    wrist_enchant,
    wrist_amplification_name,
    wrist_upgrade_info_item_name,
    wrist_upgrade_info_item_rarity,
    wrist_upgrade_info_set_item_name,
    wrist_tune_level,
    ring_item_name,
    ring_item_available_level,
    ring_item_rarity,
    ring_set_item_name,
    ring_reinforce,
    ring_item_grade_name,
    ring_enchant,
    ring_amplification_name,
    ring_upgrade_info_item_name,
    ring_upgrade_info_item_rarity,
    ring_upgrade_info_set_item_name,
    ring_tune_level,
    support_item_name,
    support_item_available_level,
    support_item_rarity,
    support_set_item_name,
    support_reinforce,
    support_item_grade_name,
    support_enchant,
    support_amplification_name,
    support_fusion_option,
    support_upgrade_info_item_name,
    support_upgrade_info_item_rarity,
    support_upgrade_info_set_item_name,
    support_tune_level,
    magic_ston_item_name,
    magic_ston_item_available_level,
    magic_ston_item_rarity,
    magic_ston_set_item_name,
    magic_ston_reinforce,
    magic_ston_item_grade_name,
    magic_ston_enchant,
    magic_ston_amplification_name,
    magic_ston_fusion_option,
    magic_ston_upgrade_info_item_name,
    magic_ston_upgrade_info_item_rarity,
    magic_ston_upgrade_info_set_item_name,
    magic_ston_tune_level,
    earring_item_name,
    earring_item_available_level,
    earring_item_rarity,
    earring_set_item_name,
    earring_reinforce,
    earring_item_grade_name,
    earring_enchant,
    earring_amplification_name,
    earring_fusion_option,
    earring_upgrade_info_item_name,
    earring_upgrade_info_item_rarity,
    earring_upgrade_info_set_item_name,
    earring_tune_level,
    magic_ston_potency_value,
    earring_potency_value,
    SPLIT_PART(set_item_info, '||', 1) AS total_set_item_name,
    NULLIF(SPLIT_PART(set_item_info, '||', 2), '')::SMALLINT AS total_set_point,
    fetched_at
FROM staging_character_equipment;